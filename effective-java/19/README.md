# 19: Design and document for inheritance or else prohibit it

* Design & document for inheritance
* Prohibit it

## Design & document for inheritance

* The class must document its *self-use* of *overridable* methods (*nonfinal* and either *public* or *protected*), so clients know precisely the ffects of overriding any method.

* The class must document any circumstances under which it might invoke an overridable method.

> Description usually is in a special section of the specification, labeled *"implementation Requirements"*, which is generated by the Javadoc tag `@implSpec`.

* This violates the dictum that good API documentation should describe *what* a given method does and not *how* it does it. This is an unfortunate consequence of the fact that inheritance violates encapsulationTo document a class so that it can be safely subclassed, you must describe implementation details that should otherwise be left unspecified.

* When you design for inheritance a class that is likely to achieve wide use, realize that you are comitting *forever* to the self-use patterns that you document and to the implementation decisions implicit in its protected methods and fields.

* The *only* way to test a class designed for inheritance is to write subclasses. Therefore, you must test your class by writing subclasses before you release it.

* Constructors must not invoke overridable methods, directly or indirectly. The superclass constructor runs before the subclass constructor, so the overriding method in the subclass will get invoked before the subclass constructor has run. If the overriding method depends on any initialization performed by the subclass constructor, the method will not behave as expected.

## Prohibit it

The best solution is to prohibit subclassing in classes that are not designed and documented to be safely subclassed.

* Declare the class `final`.

* Make all constructors private or package-private and add public static factories in place. This alternative provides the flexibility to use subclasses internally.

* If you must allow inheritance from a class that does not implement a standard interface, eliminate the class's self-use of overridable methods entirely and document this fact. Overriding a method will never affect the behavior of any other method. You can do this mechanically, without changing its behavior, by moving the body of each overridable method to a private "helper method" and have each overridable method with a direct invocation of the overridable method's private helper method.
